<abstract:ADumbComponent x:Class="WpfApp2.Shared.UI.ObsLoadingSpinner"
                         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                         xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                         xmlns:abstract="clr-namespace:WpfApp2.Shared.Abstract"
                         xmlns:ui="clr-namespace:WpfApp2.Shared.UI"
                         mc:Ignorable="d"
                         d:DesignHeight="300" d:DesignWidth="300">

    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />

        <Storyboard x:Key="SpinnerAnimation" RepeatBehavior="Forever">
            <DoubleAnimation Storyboard.TargetName="SpinnerRing"
                             Storyboard.TargetProperty="(UIElement.RenderTransform).(RotateTransform.Angle)"
                             From="0" To="360"
                             Duration="0:0:1.2"
                             EasingFunction="{x:Null}" />
        </Storyboard>
    </UserControl.Resources>

    <Grid DataContext="{Binding RelativeSource={RelativeSource AncestorType=ui:ObsLoadingSpinner}}"
          Visibility="{Binding IsLoading, Converter={StaticResource BooleanToVisibilityConverter}}">

        <!-- Semi-transparent black overlay -->
        <Grid.Background>
            <SolidColorBrush Color="Black" Opacity="0.5" />
        </Grid.Background>

        <!-- Spinner container -->
        <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
            <Grid.Triggers>
                <EventTrigger RoutedEvent="Loaded">
                    <BeginStoryboard Storyboard="{StaticResource SpinnerAnimation}" />
                </EventTrigger>
            </Grid.Triggers>

            <!-- Outer ring -->
            <Ellipse Width="50" Height="50"
                     Stroke="#20FFFFFF"
                     StrokeThickness="3"
                     Opacity="0.3" />

            <!-- Animated spinner ring with gradient -->
            <Ellipse x:Name="SpinnerRing"
                     Width="50" Height="50"
                     RenderTransformOrigin="0.5,0.5">
                <Ellipse.RenderTransform>
                    <RotateTransform Angle="0" />
                </Ellipse.RenderTransform>
                <Ellipse.Stroke>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                        <GradientStop Color="#007bff" Offset="0" />
                        <GradientStop Color="#0056b3" Offset="0.5" />
                        <GradientStop Color="Transparent" Offset="1" />
                    </LinearGradientBrush>
                </Ellipse.Stroke>
                <Ellipse.StrokeThickness>3</Ellipse.StrokeThickness>
                <Ellipse.Effect>
                    <DropShadowEffect Color="#007bff"
                                      BlurRadius="8"
                                      ShadowDepth="0"
                                      Opacity="0.6" />
                </Ellipse.Effect>
            </Ellipse>
        </Grid>
    </Grid>

</abstract:ADumbComponent>